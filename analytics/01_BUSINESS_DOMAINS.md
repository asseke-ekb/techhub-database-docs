# Бизнес-домены TechHub

## Обзор доменной модели

TechHub построен по принципу доменно-ориентированной архитектуры. Каждый домен отвечает за определённую бизнес-область.

---

## 1. Домен ACCOUNT — Управление идентификацией

### Назначение
Управление пользователями, компаниями и их взаимосвязями. Это центральный домен, от которого зависят все остальные.

### Бизнес-возможности
- Регистрация и аутентификация пользователей
- Регистрация и верификация компаний
- Управление членством сотрудников в компаниях
- Система тегов и статусов для категоризации
- Управление профилями и настройками

### Ключевые сущности

| Сущность | Таблица | Записей | Описание |
|----------|---------|---------|----------|
| Пользователь | `account_user` | 54,063 | Зарегистрированное физическое лицо |
| Компания | `account_company` | 6,639 | Юридическое лицо или ИП |
| Членство | `account_usercompany` | 4,536 | Связь пользователя с компанией |
| Код активации | `account_activation` | 1,810 | Коды подтверждения (регистрация, сброс пароля) |

### Бизнес-правила

**Пользователи:**
- Пользователь регистрируется по email или телефону
- Email и телефон требуют подтверждения (коды активации)
- Пользователь может быть заблокирован администратором
- Пользователь может иметь системную роль (user, admin, expert и др.)
- Пользователь получает теги в зависимости от активности (investor, it_specialist, intern)

**Компании:**
- Компания создаётся пользователем и требует верификации
- Компания имеет тип: юр.лицо (law), ИП (ip), не определено (unknown)
- Компания получает теги-статусы: IT-компания, стартап, резидент технопарка
- Компания может быть заблокирована

**Членство в компании:**
- Один пользователь может состоять в нескольких компаниях
- В каждой компании только ОДИН владелец (owner)
- Роли: owner (владелец), member (сотрудник), advisor (консультант)
- Членство требует подтверждения владельцем

### Интеграции с другими доменами

```
ACCOUNT ──→ SERVICE (автор заявки, компания-заявитель)
       ──→ CORE (автор события/вакансии/блога)
       ──→ BOOKING (кто бронирует)
       ──→ TECHORDA (студент программы)
```

---

## 2. Домен SERVICE — Государственные услуги

### Назначение
Предоставление государственных и сервисных услуг IT-экосистеме: аккредитация, гранты, резидентство, визовая поддержка.

### Бизнес-возможности
- Каталог услуг с описанием и требованиями
- Подача и обработка заявок
- Многошаговые формы заявок
- Экспертиза и голосование
- Отчётность по грантам

### Ключевые сущности

| Сущность | Таблица | Записей | Описание |
|----------|---------|---------|----------|
| Услуга | `service_service` | 310 | Каталог доступных услуг |
| Заявка | `service_servicerequest` | 56,322 | Поданная заявка на услугу |
| Форма | `service_hubform` | 282 | Шаблон формы для заявки |
| Поле формы | `service_hubformfield` | 6,603 | Поля в формах |
| Данные формы | `service_hubformdata` | 61,635 | Заполненные данные |
| Экспертиза | `service_expertise` | 787 | Экспертные оценки заявок |
| Протокол | `service_protocol` | 104 | Протоколы решений комиссии |
| Отчёт | `service_report` | 13,110 | Отчёты по грантам |

### Основные услуги

| Код услуги | Название | Описание |
|------------|----------|----------|
| `accreditation` | Аккредитация IT-компании | Получение статуса аккредитованной IT-компании |
| `startup_register` | Реестр стартапов | Включение в официальный реестр стартапов |
| `techpark_register` | Резидентство технопарка | Получение статуса резидента Astana Hub |
| `seedmoney` | Грант Seed Money | Заявка на грантовое финансирование |
| `techorda_request` | TechOrda | Заявка на образовательную программу |
| `visa_support` | Визовая поддержка | Помощь в получении визы |
| `mat_pass` | Материальный пропуск | Пропуск для провоза материалов |

### Жизненный цикл заявки

```
┌─────────┐     отправить     ┌─────────┐     проверка     ┌──────────┐
│  draft  │──────────────────→│  sent   │─────────────────→│ approved │
│(черновик)│                   │(на рассм.)│                 │(одобрена)│
└─────────┘                   └────┬────┘                   └────┬─────┘
                                   │                              │
                             доработка                       экспертиза
                                   │                              │
                                   ▼                              ▼
                            ┌───────────┐                  ┌──────────┐
                            │correction │                  │ success  │
                            │(доработка)│                  │(успешно) │
                            └─────┬─────┘                  └──────────┘
                                  │
                            повторная                      ┌──────────┐
                            отправка ─────────────────────→│  reject  │
                                                           │(отклонена)│
                                                           └──────────┘
```

### Бизнес-правила

- Заявку подаёт пользователь от своего имени или от имени компании
- Заявка проходит проверку модератором
- Некоторые услуги требуют экспертизы (голосование экспертов)
- По грантам требуется периодическая отчётность
- История изменений статусов фиксируется

---

## 3. Домен CORE — Контент-платформа

### Назначение
Управление контентом платформы: мероприятия, вакансии, блоги, статьи, новости.

### Бизнес-возможности
- Создание и модерация мероприятий
- Публикация вакансий и обработка откликов
- Блоги пользователей и компаний
- Статьи и новости от редакции
- Комментарии и обсуждения

### Ключевые сущности

| Сущность | Таблица | Записей | Описание |
|----------|---------|---------|----------|
| Событие | `core_event` | 1,459 | Мероприятие (митап, конференция) |
| Участник события | `core_eventparticipant` | 864 | Регистрация на событие |
| Вакансия | `core_vacancy` | 1,205 | Вакансия от компании |
| Кандидат | `core_vacancycandidate` | 5,344 | Отклик на вакансию |
| Блог | `core_blog` | 1,801 | Публикация пользователя/компании |
| Статья | `core_article` | 83 | Редакционная статья |
| Комментарий | `core_comment` | 2,585 | Комментарии к контенту |
| Лента | `core_feed` | 4,789 | Агрегированная лента новостей |

### Типы мероприятий

| Тип | Код | Описание |
|-----|-----|----------|
| Открытое | `open_event` | Доступно для всех |
| Закрытое | `closed_event` | Только по приглашениям |

### Форматы мероприятий

| Формат | Код | Описание |
|--------|-----|----------|
| Офлайн | `astanahub` | В помещении Astana Hub |
| Онлайн | `online` | Онлайн-трансляция |
| Гибрид | `hybrid` | Офлайн + онлайн |

### Типы вакансий

| Тип | Код | Описание |
|-----|-----|----------|
| Полная занятость | `fulltime` | Полный рабочий день |
| Частичная | `parttime` | Неполный день |
| Стажировка | `internship` | Стажировка |
| Проект | `project` | Проектная работа |
| Волонтёрство | `volunteering` | Волонтёрская работа |

### Жизненный цикл контента

```
┌─────────┐     отправить     ┌─────────┐
│  draft  │──────────────────→│  sent   │
│(черновик)│                   │(модерация)│
└─────────┘                   └────┬────┘
                                   │
                    ┌──────────────┼──────────────┐
                    │              │              │
                    ▼              ▼              ▼
             ┌───────────┐  ┌──────────┐  ┌──────────┐
             │correction │  │ success  │  │  reject  │
             │(доработка)│  │(опубл.)  │  │(отклонён)│
             └─────┬─────┘  └──────────┘  └──────────┘
                   │
                   └────→ sent (повторная отправка)
```

### Бизнес-правила

- Контент создаётся пользователем или компанией
- Весь контент проходит модерацию перед публикацией
- Модератор может отправить на доработку или отклонить
- Мультиязычный контент (ru/kk/en) хранится в JSONB
- Комментарии привязываются полиморфно (к любому типу контента)

---

## 4. Домен BOOKING — Бронирование

### Назначение
Бронирование ресурсов технопарка: переговорные комнаты, рабочие места, конференц-залы.

### Бизнес-возможности
- Каталог доступных помещений
- Просмотр расписания занятости
- Бронирование на время
- Отмена бронирования

### Ключевые сущности

| Сущность | Таблица | Записей | Описание |
|----------|---------|---------|----------|
| Комната | `booking_room` | 30 | Доступное помещение |
| Бронирование | `booking_booking` | 8,628 | Факт бронирования |
| Рабочее время | `booking_worktime` | 14 | Расписание работы комнат |

### Статусы бронирования

| Статус | Код | Описание |
|--------|-----|----------|
| Активное | `active` | Бронирование подтверждено |
| Завершено | `finished` | Время прошло |
| Отменено | `deactivated` | Отменено пользователем |

### Бизнес-правила

- Бронирование создаётся пользователем
- Время бронирования не может пересекаться
- Бронирование можно отменить до начала
- После окончания времени статус автоматически меняется на `finished`

---

## 5. Домен TECHORDA — Образование

### Назначение
Управление образовательными программами TechOrda для подготовки IT-специалистов.

### Бизнес-возможности
- Каталог образовательных программ
- Подача заявок на обучение
- Отслеживание студентов
- Отчётность по программам

### Ключевые сущности

| Сущность | Таблица | Записей | Описание |
|----------|---------|---------|----------|
| Программа | `techorda_program` | 46 | Образовательная программа |
| Поток | `techorda_stream` | 88 | Поток обучения |
| Школа | `techorda_school` | 23 | Партнёрская школа |
| Студент | `service_techordastudent` | 3,307 | Студент программы |
| Отчёт | `service_techordareport` | 503 | Отчёт по программе |

### Бизнес-правила

- Программа имеет несколько потоков
- Заявка подаётся через модуль SERVICE
- Студент получает тег `tag_intern` после обучения
- По программам формируется периодическая отчётность

---

## 6. Домен NIOKR — Научные проекты

### Назначение
Управление научно-исследовательскими и опытно-конструкторскими работами.

### Бизнес-возможности
- Регистрация НИОКР проектов
- Подача заявок от недропользователей
- Экспертиза проектов
- Отслеживание выполнения

### Ключевые сущности

| Сущность | Таблица | Записей | Описание |
|----------|---------|---------|----------|
| Проект | `niokr_project` | — | НИОКР проект |
| Заявка | `niokr_request` | — | Заявка недропользователя |
| Отчёт | `niokr_report` | — | Отчёт по проекту |

### Бизнес-правила

- Проекты связаны с компаниями-недропользователями (`tag_nedrouser`)
- Проекты проходят экспертизу
- Требуется периодическая отчётность

---

## 7. Домен SHARED — Общие компоненты

### Назначение
Общие компоненты, используемые во всех доменах.

### Компоненты

| Компонент | Таблица | Описание |
|-----------|---------|----------|
| Файлы | `shared_file` | Хранение загруженных файлов |
| Регион | `shared_region` | Справочник регионов |
| Уведомления | `core_notification` | Системные уведомления |
| Логи действий | `core_actionlog` | Аудит действий пользователей |

---

## Матрица взаимодействия доменов

| Домен | ACCOUNT | SERVICE | CORE | BOOKING | TECHORDA | NIOKR |
|-------|---------|---------|------|---------|----------|-------|
| **ACCOUNT** | — | автор/компания | автор/компания | пользователь | студент | компания |
| **SERVICE** | заявитель | — | — | — | заявки | заявки |
| **CORE** | автор | — | — | — | — | — |
| **BOOKING** | бронирующий | — | — | — | — | — |
| **TECHORDA** | студент | заявки | — | — | — | — |
| **NIOKR** | компания | заявки | — | — | — | — |

---

## Следующий раздел

[02_ENTITIES.md](02_ENTITIES.md) — Детальное описание ключевых сущностей
