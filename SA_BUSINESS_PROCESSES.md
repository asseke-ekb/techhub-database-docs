# Описание бизнес-процессов
## Информационная система TechHub

**Версия:** 1.0
**Дата:** 2025-12-04

---

## 1. Диаграмма вариантов использования (Use Case)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           USE CASE DIAGRAM                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│                              ┌─────────────────────────────────────────┐    │
│                              │            СИСТЕМА TECHHUB              │    │
│                              │                                         │    │
│  ┌──────────┐                │  ┌─────────────────────────────────┐   │    │
│  │          │                │  │      УПРАВЛЕНИЕ АККАУНТОМ       │   │    │
│  │Посетитель│───────────────▶│  │  ○ Регистрация                  │   │    │
│  │  (Guest) │                │  │  ○ Авторизация                  │   │    │
│  │          │                │  │  ○ Восстановление пароля        │   │    │
│  └──────────┘                │  └─────────────────────────────────┘   │    │
│       │                      │                                         │    │
│       │                      │  ┌─────────────────────────────────┐   │    │
│       ▼                      │  │     УПРАВЛЕНИЕ КОМПАНИЕЙ        │   │    │
│  ┌──────────┐                │  │  ○ Создать компанию             │   │    │
│  │          │───────────────▶│  │  ○ Редактировать профиль        │   │    │
│  │Пользова- │                │  │  ○ Пригласить сотрудника        │   │    │
│  │   тель   │                │  │  ○ Подать на верификацию        │   │    │
│  │          │                │  └─────────────────────────────────┘   │    │
│  └──────────┘                │                                         │    │
│       │                      │  ┌─────────────────────────────────┐   │    │
│       │                      │  │       ПОДАЧА ЗАЯВОК             │   │    │
│       │                      │  │  ○ Выбрать услугу               │   │    │
│       │         ────────────▶│  │  ○ Заполнить форму              │   │    │
│       │                      │  │  ○ Отправить заявку             │   │    │
│       │                      │  │  ○ Отслеживать статус           │   │    │
│       │                      │  └─────────────────────────────────┘   │    │
│       │                      │                                         │    │
│       │                      │  ┌─────────────────────────────────┐   │    │
│       │         ────────────▶│  │     КОНТЕНТ-МЕНЕДЖМЕНТ          │   │    │
│       │                      │  │  ○ Создать событие              │   │    │
│       │                      │  │  ○ Опубликовать вакансию        │   │    │
│       │                      │  │  ○ Написать блог-пост           │   │    │
│       │                      │  │  ○ Оставить комментарий         │   │    │
│       ▼                      │  └─────────────────────────────────┘   │    │
│  ┌──────────┐                │                                         │    │
│  │          │                │  ┌─────────────────────────────────┐   │    │
│  │ Модератор│───────────────▶│  │        МОДЕРАЦИЯ                │   │    │
│  │          │                │  │  ○ Проверить контент            │   │    │
│  └──────────┘                │  │  ○ Одобрить/Отклонить           │   │    │
│       │                      │  │  ○ Назначить на доработку       │   │    │
│       │                      │  └─────────────────────────────────┘   │    │
│       ▼                      │                                         │    │
│  ┌──────────┐                │  ┌─────────────────────────────────┐   │    │
│  │          │───────────────▶│  │       ЭКСПЕРТИЗА                │   │    │
│  │  Эксперт │                │  │  ○ Получить заявку              │   │    │
│  │          │                │  │  ○ Провести экспертизу          │   │    │
│  └──────────┘                │  │  ○ Выставить оценку             │   │    │
│       │                      │  │  ○ Сформировать заключение      │   │    │
│       │                      │  └─────────────────────────────────┘   │    │
│       ▼                      │                                         │    │
│  ┌──────────┐                │  ┌─────────────────────────────────┐   │    │
│  │          │───────────────▶│  │      АДМИНИСТРИРОВАНИЕ          │   │    │
│  │  Админ   │                │  │  ○ Управлять пользователями     │   │    │
│  │          │                │  │  ○ Управлять услугами           │   │    │
│  └──────────┘                │  │  ○ Настраивать формы            │   │    │
│                              │  │  ○ Просматривать отчёты         │   │    │
│                              │  └─────────────────────────────────┘   │    │
│                              │                                         │    │
│                              └─────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 2. Бизнес-процессы

### 2.1. BP-001: Регистрация пользователя

**Идентификатор:** BP-001
**Название:** Регистрация нового пользователя
**Владелец процесса:** Отдел поддержки пользователей
**Участники:** Посетитель, Система

#### Описание
Процесс регистрации нового пользователя в системе TechHub через телефон или email.

#### Диаграмма процесса

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    BP-001: РЕГИСТРАЦИЯ ПОЛЬЗОВАТЕЛЯ                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────┐                                                                │
│  │  START  │                                                                │
│  └────┬────┘                                                                │
│       │                                                                      │
│       ▼                                                                      │
│  ┌─────────────────┐                                                        │
│  │ Открыть форму   │                                                        │
│  │ регистрации     │                                                        │
│  └────────┬────────┘                                                        │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────┐     ┌─────────────────┐                               │
│  │ Ввести телефон  │     │  Выбрать OAuth  │                               │
│  │ или email       │     │ (Google, etc.)  │                               │
│  └────────┬────────┘     └────────┬────────┘                               │
│           │                       │                                          │
│           ▼                       │                                          │
│  ┌─────────────────┐              │                                          │
│  │ Система создаёт │              │                                          │
│  │ account_        │              │                                          │
│  │ activation      │              │                                          │
│  │ (code=XXXXXX)   │              │                                          │
│  └────────┬────────┘              │                                          │
│           │                       │                                          │
│           ▼                       │                                          │
│  ┌─────────────────┐              │                                          │
│  │ Отправить SMS/  │              │                                          │
│  │ Email с кодом   │              │                                          │
│  └────────┬────────┘              │                                          │
│           │                       │                                          │
│           ▼                       ▼                                          │
│  ┌─────────────────┐     ┌─────────────────┐                               │
│  │ Пользователь    │     │ Авторизация     │                               │
│  │ вводит код      │     │ через OAuth     │                               │
│  └────────┬────────┘     └────────┬────────┘                               │
│           │                       │                                          │
│           ▼                       │                                          │
│      ◇─────────◇                  │                                          │
│     ╱           ╲                 │                                          │
│    ╱  Код верный? ╲               │                                          │
│    ╲             ╱                │                                          │
│     ╲           ╱                 │                                          │
│      ◇────┬────◇                  │                                          │
│      │    │    │                  │                                          │
│     Да   Нет   │                  │                                          │
│      │    │    │                  │                                          │
│      │    ▼    │                  │                                          │
│      │ [iteration++]              │                                          │
│      │ [if iteration>3           │                                          │
│      │  → блокировка]            │                                          │
│      │         │                  │                                          │
│      │         │                  │                                          │
│      ▼─────────┴──────────────────┘                                          │
│  ┌─────────────────┐                                                        │
│  │ Создать         │                                                        │
│  │ account_user    │                                                        │
│  │ (is_active=true)│                                                        │
│  └────────┬────────┘                                                        │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────┐                                                        │
│  │ Заполнить       │                                                        │
│  │ профиль         │                                                        │
│  └────────┬────────┘                                                        │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────┐                                                                │
│  │   END   │                                                                │
│  └─────────┘                                                                │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

#### Таблицы данных
- `account_activation` - создаётся запись с кодом
- `account_user` - создаётся запись пользователя
- `social_auth_usersocialauth` - при OAuth регистрации

#### Бизнес-правила
- BR-001: Код активации действителен 10 минут
- BR-002: Максимум 3 попытки ввода кода
- BR-003: Телефон/email должен быть уникальным

---

### 2.2. BP-002: Регистрация компании

**Идентификатор:** BP-002
**Название:** Регистрация компании
**Владелец процесса:** Отдел регистрации
**Участники:** Пользователь, Система, Модератор

#### Диаграмма процесса

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    BP-002: РЕГИСТРАЦИЯ КОМПАНИИ                              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ПОЛЬЗОВАТЕЛЬ              СИСТЕМА                    МОДЕРАТОР             │
│  ────────────              ───────                    ─────────             │
│       │                        │                          │                 │
│       ▼                        │                          │                 │
│  ┌─────────────┐               │                          │                 │
│  │Заполнить    │               │                          │                 │
│  │форму        │               │                          │                 │
│  │регистрации  │               │                          │                 │
│  │компании     │               │                          │                 │
│  └──────┬──────┘               │                          │                 │
│         │                      │                          │                 │
│         │ БИН, название,       │                          │                 │
│         │ адрес, контакты      │                          │                 │
│         │                      │                          │                 │
│         └─────────────────────▶│                          │                 │
│                                ▼                          │                 │
│                         ┌─────────────┐                   │                 │
│                         │Проверить    │                   │                 │
│                         │уникальность │                   │                 │
│                         │БИН          │                   │                 │
│                         └──────┬──────┘                   │                 │
│                                │                          │                 │
│                           ◇────┴────◇                     │                 │
│                          ╱           ╲                    │                 │
│                         ╱ БИН уникален?╲                  │                 │
│                         ╲             ╱                   │                 │
│                          ╲           ╱                    │                 │
│                           ◇────┬────◇                     │                 │
│                          Да    │   Нет                    │                 │
│                           │    │    │                     │                 │
│                           │    │    ▼                     │                 │
│                           │    │ [Ошибка:                 │                 │
│                           │    │  компания уже            │                 │
│                           │    │  существует]             │                 │
│                           │    │                          │                 │
│                           ▼    │                          │                 │
│                    ┌─────────────┐                        │                 │
│                    │Создать      │                        │                 │
│                    │account_     │                        │                 │
│                    │company      │                        │                 │
│                    │(verified=   │                        │                 │
│                    │ false)      │                        │                 │
│                    └──────┬──────┘                        │                 │
│                           │                               │                 │
│                           ▼                               │                 │
│                    ┌─────────────┐                        │                 │
│                    │Создать      │                        │                 │
│                    │account_     │                        │                 │
│                    │usercompany  │                        │                 │
│                    │(role=owner) │                        │                 │
│                    └──────┬──────┘                        │                 │
│                           │                               │                 │
│       ◀───────────────────┘                               │                 │
│       │                                                   │                 │
│       ▼                                                   │                 │
│  ┌─────────────┐                                          │                 │
│  │Подать заявку│                                          │                 │
│  │на аккреди-  │─────────────────────────────────────────▶│                 │
│  │тацию        │                                          │                 │
│  │(опционально)│                                          ▼                 │
│  └─────────────┘                                   ┌─────────────┐          │
│                                                    │Проверить    │          │
│                                                    │документы    │          │
│                                                    └──────┬──────┘          │
│                                                           │                 │
│                                                      ◇────┴────◇            │
│                                                     ╱           ╲           │
│                                                    ╱  Одобрить?  ╲          │
│                                                    ╲             ╱          │
│                                                     ╲           ╱           │
│                                                      ◇────┬────◇            │
│                                                     Да    │   Нет           │
│                                                      │    │    │            │
│                                                      ▼    │    ▼            │
│                                               [verified   │  [reject]       │
│                                                =true]     │                 │
│                                                           │                 │
└─────────────────────────────────────────────────────────────────────────────┘
```

#### Таблицы данных
- `account_company` - создаётся запись компании
- `account_usercompany` - связь пользователь-компания (role=owner)
- `service_servicerequest` - при подаче на аккредитацию

---

### 2.3. BP-003: Подача заявки на услугу

**Идентификатор:** BP-003
**Название:** Подача и обработка заявки на услугу
**Владелец процесса:** Отдел услуг
**Участники:** Пользователь, Система, Модератор, Эксперт

#### Диаграмма процесса (BPMN-style)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    BP-003: ПОДАЧА ЗАЯВКИ НА УСЛУГУ                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ЗАЯВИТЕЛЬ         СИСТЕМА          МОДЕРАТОР         ЭКСПЕРТ              │
│  ─────────         ───────          ─────────         ───────              │
│      │                │                 │                │                  │
│      ▼                │                 │                │                  │
│ ┌──────────┐          │                 │                │                  │
│ │ Выбрать  │          │                 │                │                  │
│ │ услугу   │          │                 │                │                  │
│ └────┬─────┘          │                 │                │                  │
│      │                │                 │                │                  │
│      ▼                │                 │                │                  │
│ ┌──────────┐          │                 │                │                  │
│ │Заполнить │          │                 │                │                  │
│ │ форму    │          │                 │                │                  │
│ │(hubform) │          │                 │                │                  │
│ └────┬─────┘          │                 │                │                  │
│      │                │                 │                │                  │
│      │ [service_hubformdata]            │                │                  │
│      │                │                 │                │                  │
│      ▼                │                 │                │                  │
│ ┌──────────┐          │                 │                │                  │
│ │Сохранить │─────────▶│                 │                │                  │
│ │черновик  │          │                 │                │                  │
│ │(draft)   │          ▼                 │                │                  │
│ └──────────┘   ┌─────────────┐          │                │                  │
│      │         │servicerequest│          │                │                  │
│      │         │status=draft │          │                │                  │
│      │         └─────────────┘          │                │                  │
│      │                │                 │                │                  │
│      ▼                │                 │                │                  │
│ ┌──────────┐          │                 │                │                  │
│ │Отправить │─────────▶│                 │                │                  │
│ │на рассм. │          ▼                 │                │                  │
│ └──────────┘   ┌─────────────┐          │                │                  │
│                │status=sent  │──────────▶                │                  │
│                └─────────────┘          │                │                  │
│                       │                 ▼                │                  │
│                       │          ┌──────────┐            │                  │
│                       │          │Проверить │            │                  │
│                       │          │заявку    │            │                  │
│                       │          └────┬─────┘            │                  │
│                       │               │                  │                  │
│                       │          ◇────┴────◇             │                  │
│                       │         ╱           ╲            │                  │
│                       │        ╱ Корректна?  ╲           │                  │
│                       │        ╲             ╱           │                  │
│                       │         ╲           ╱            │                  │
│                       │          ◇────┬────◇             │                  │
│                       │         Да    │   Нет            │                  │
│                       │          │    │    │             │                  │
│                       │          │    │    ▼             │                  │
│                       │          │    │ [correction]     │                  │
│      ◀───────────────────────────────────┘               │                  │
│      │ (доработка)    │          │                       │                  │
│      │                │          ▼                       │                  │
│      │                │   ┌──────────┐                   │                  │
│      │                │   │Назначить │───────────────────▶                  │
│      │                │   │эксперта  │                   │                  │
│      │                │   └──────────┘                   ▼                  │
│      │                │          │                ┌──────────┐              │
│      │                │          │                │Провести  │              │
│      │                │          │                │экспертизу│              │
│      │                │          │                └────┬─────┘              │
│      │                │          │                     │                    │
│      │                │          │                ◇────┴────◇               │
│      │                │          │               ╱           ╲              │
│      │                │          │              ╱  Одобрить?  ╲             │
│      │                │          │              ╲             ╱             │
│      │                │          │               ╲           ╱              │
│      │                │          │                ◇────┬────◇               │
│      │                │          │               Да    │   Нет              │
│      │                │          │                │    │    │               │
│      │                │          │                ▼    │    ▼               │
│      │                │          │         ┌──────────┐│┌──────────┐        │
│      │                │          │         │approved  │││ reject   │        │
│      │                │          │         └────┬─────┘│└──────────┘        │
│      │                │          │              │      │                    │
│      │                │          │              ▼      │                    │
│      │                │          │       ┌──────────┐  │                    │
│      │                │          │       │Протокол  │  │                    │
│      │                │          │       │комиссии  │  │                    │
│      │                │          │       └────┬─────┘  │                    │
│      │                │          │            │        │                    │
│      │                │          │            ▼        │                    │
│      │                │          │     ┌──────────┐    │                    │
│      │                │          │     │ SUCCESS  │    │                    │
│      │                │          │     └──────────┘    │                    │
│      │                │          │                     │                    │
└─────────────────────────────────────────────────────────────────────────────┘
```

#### Состояния заявки (State Machine)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    SERVICE REQUEST STATE MACHINE                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│                              ┌────────┐                                     │
│                              │ draft  │ ◀─────────────────────┐             │
│                              └───┬────┘                       │             │
│                                  │                            │             │
│                                  │ [Отправить]                │             │
│                                  ▼                            │             │
│                              ┌────────┐                       │             │
│                         ┌───▶│  sent  │◀──────────┐           │             │
│                         │    └───┬────┘           │           │             │
│                         │        │                │           │             │
│           [Доработка]   │        │ [Модератор]    │           │             │
│                         │        ▼                │           │             │
│                    ┌────────┐    │           ┌────────────┐   │             │
│                    │correct-│◀───┼───────────│ [Вернуть   │   │             │
│                    │  ion   │    │           │на доработку│   │             │
│                    └────────┘    │           └────────────┘   │             │
│                         │        │                            │             │
│                         │        ▼                            │             │
│            [Исправить]  │   ┌─────────┐                       │             │
│                         └───│approved │                       │             │
│                             └────┬────┘                       │             │
│                                  │                            │             │
│                                  │ [Эксперт/Комиссия]         │             │
│                                  │                            │             │
│                    ┌─────────────┼─────────────┐              │             │
│                    │             │             │              │             │
│                    ▼             ▼             ▼              │             │
│               ┌────────┐   ┌─────────┐   ┌────────┐          │             │
│               │ reject │   │ success │   │rejected│          │             │
│               └────────┘   └─────────┘   └────────┘          │             │
│                    │                           │              │             │
│                    │      ФИНАЛЬНЫЕ            │              │             │
│                    │       СТАТУСЫ             │              │             │
│                    └───────────────────────────┘              │             │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

#### Таблицы данных
- `service_service` - выбор услуги
- `service_hubform` - шаблон формы
- `service_hubformdata` - заполненные данные
- `service_servicerequest` - заявка
- `service_servicerequestlog` - история изменений
- `service_servicerequeststatus` - статусы
- `service_expertise` - экспертиза
- `service_vote` - голоса экспертов
- `service_protocol` - протокол комиссии
- `service_report` - отчёты

---

### 2.4. BP-004: Публикация контента (Событие/Вакансия/Блог)

**Идентификатор:** BP-004
**Название:** Публикация контента с модерацией
**Владелец процесса:** Контент-отдел

#### Диаграмма процесса

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    BP-004: ПУБЛИКАЦИЯ КОНТЕНТА                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   АВТОР                    СИСТЕМА                    МОДЕРАТОР             │
│   ─────                    ───────                    ─────────             │
│     │                         │                           │                 │
│     ▼                         │                           │                 │
│ ┌──────────┐                  │                           │                 │
│ │Создать   │                  │                           │                 │
│ │контент   │                  │                           │                 │
│ │(event/   │                  │                           │                 │
│ │vacancy/  │                  │                           │                 │
│ │blog)     │                  │                           │                 │
│ └────┬─────┘                  │                           │                 │
│      │                        │                           │                 │
│      │ [title, content,       │                           │                 │
│      │  datetime, etc.]       │                           │                 │
│      │                        │                           │                 │
│      └───────────────────────▶│                           │                 │
│                               ▼                           │                 │
│                        ┌─────────────┐                    │                 │
│                        │ status=draft│                    │                 │
│                        │ published=  │                    │                 │
│                        │   false     │                    │                 │
│                        └──────┬──────┘                    │                 │
│      ◀────────────────────────┘                           │                 │
│      │                        │                           │                 │
│      ▼                        │                           │                 │
│ ┌──────────┐                  │                           │                 │
│ │Отправить │─────────────────▶│                           │                 │
│ │на модер. │                  ▼                           │                 │
│ └──────────┘           ┌─────────────┐                    │                 │
│                        │ status=sent │────────────────────▶                 │
│                        └─────────────┘                    │                 │
│                               │                           ▼                 │
│                               │                    ┌──────────┐             │
│                               │                    │Проверить │             │
│                               │                    │контент   │             │
│                               │                    └────┬─────┘             │
│                               │                         │                   │
│                               │                    ◇────┴────◇              │
│                               │                   ╱           ╲             │
│                               │                  ╱  Решение?   ╲            │
│                               │                  ╲             ╱            │
│                               │                   ╲           ╱             │
│                               │                    ◇────┬────◇              │
│                               │                   ╱     │     ╲             │
│                               │               Одобр.  Доработ. Отклон.      │
│                               │                 │       │       │           │
│                               │                 ▼       │       ▼           │
│                               │          ┌──────────┐   │  ┌──────────┐    │
│                               │          │ success  │   │  │  reject  │    │
│                               │          │published │   │  └──────────┘    │
│                               │          │ =true    │   │                   │
│                               │          └──────────┘   │                   │
│                               │                 │       │                   │
│                               │                 ▼       │                   │
│                               │          ┌──────────┐   │                   │
│                               │          │Добавить в│   │                   │
│                               │          │core_feed │   │                   │
│                               │          └──────────┘   ▼                   │
│                               │                  ┌──────────┐               │
│      ◀───────────────────────────────────────────│correction│               │
│      │                        │                  └──────────┘               │
│      │ [исправить]            │                                             │
│      │                        │                                             │
│      ▼                        │                                             │
│ ┌──────────┐                  │                                             │
│ │Исправить │                  │                                             │
│ │и повторно│                  │                                             │
│ │отправить │                  │                                             │
│ └──────────┘                  │                                             │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

### 2.5. BP-005: Бронирование комнаты

**Идентификатор:** BP-005
**Название:** Бронирование переговорной комнаты
**Владелец процесса:** Отдел администрирования

#### Диаграмма процесса

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    BP-005: БРОНИРОВАНИЕ КОМНАТЫ                              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   ПОЛЬЗОВАТЕЛЬ                         СИСТЕМА                              │
│   ────────────                         ───────                              │
│        │                                  │                                  │
│        ▼                                  │                                  │
│   ┌──────────┐                            │                                  │
│   │Выбрать   │                            │                                  │
│   │комнату   │◀───────────────────────────┤ [booking_room]                  │
│   └────┬─────┘                            │                                  │
│        │                                  │                                  │
│        ▼                                  │                                  │
│   ┌──────────┐                            │                                  │
│   │Выбрать   │                            │                                  │
│   │дату/время│                            │                                  │
│   └────┬─────┘                            │                                  │
│        │                                  │                                  │
│        │ [start, end, title]              │                                  │
│        │                                  │                                  │
│        └─────────────────────────────────▶│                                  │
│                                           ▼                                  │
│                                    ┌─────────────┐                          │
│                                    │Проверить    │                          │
│                                    │доступность  │                          │
│                                    │(нет пересеч)│                          │
│                                    └──────┬──────┘                          │
│                                           │                                  │
│                                      ◇────┴────◇                             │
│                                     ╱           ╲                            │
│                                    ╱  Доступно?  ╲                           │
│                                    ╲             ╱                           │
│                                     ╲           ╱                            │
│                                      ◇────┬────◇                             │
│                                     Да    │   Нет                            │
│                                      │    │    │                             │
│                                      ▼    │    ▼                             │
│                               ┌──────────┐│ [Ошибка:                        │
│                               │Создать   ││  время занято]                  │
│                               │booking   ││                                  │
│                               │(active)  ││                                  │
│                               └────┬─────┘│                                  │
│                                    │      │                                  │
│        ◀───────────────────────────┘      │                                  │
│        │                                  │                                  │
│        │ [Подтверждение]                  │                                  │
│        │                                  │                                  │
│        │                                  │                                  │
│   ═════╪══════════════════════════════════╪════════ [Время брони] ═════     │
│        │                                  │                                  │
│        │                                  ▼                                  │
│        │                           ┌─────────────┐                          │
│        │                           │status=      │                          │
│        │                           │  finished   │                          │
│        │                           └─────────────┘                          │
│        │                                                                     │
│   [Отмена до начала]                                                        │
│        │                                                                     │
│        ▼                                                                     │
│   ┌──────────┐                                                              │
│   │status=   │                                                              │
│   │deactivated│                                                              │
│   └──────────┘                                                              │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 3. Матрица ролей и прав доступа (RACI)

| Операция | User | Company Owner | Moderator | Expert | Admin |
|----------|------|---------------|-----------|--------|-------|
| Регистрация | R | - | - | - | - |
| Создание компании | R | R | - | - | I |
| Верификация компании | I | I | A/R | - | A |
| Подача заявки | R | R | I | - | - |
| Модерация заявки | I | I | A/R | C | I |
| Экспертиза заявки | I | I | I | A/R | I |
| Публикация контента | R | R | A | - | A |
| Бронирование | R | R | - | - | A |
| Управление пользователями | - | - | C | - | A/R |

**Легенда:**
- R - Responsible (Исполнитель)
- A - Accountable (Ответственный)
- C - Consulted (Консультируемый)
- I - Informed (Информируемый)

---

## 4. Интеграции и внешние системы

### 4.1. Внешние интеграции

| Система | Тип интеграции | Описание |
|---------|----------------|----------|
| SMS-шлюз | Исходящая | Отправка SMS кодов активации |
| Email (AWS SES) | Исходящая | Отправка email уведомлений |
| OAuth (Google, etc.) | Входящая | Социальная авторизация |
| eGov | Входящая/Исходящая | Проверка данных, ЭЦП |
| Documentolog | Исходящая | Документооборот |
| AmoCRM | Исходящая | CRM интеграция |

### 4.2. Таблицы логирования интеграций

| Таблица | Описание |
|---------|----------|
| `astanahub_shared_smslog` | Логи SMS сообщений |
| `service_documentologlog` | Логи Documentolog |
| `service_amolog` | Логи AmoCRM |
| `service_externalhooklog` | Логи внешних webhook'ов |
| `core_actionlog` | Общий лог действий |

---

*Документ является частью технической документации ИС TechHub*
